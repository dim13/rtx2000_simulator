                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ( LOAD SCREEN FOR F83 TERMINAL)   DECIMAL                                                                                       CR                                                              CR .( Generating RTX 2000 Environment Terminal program)         CR .( [c] 1989 Harris Semiconductor)                            CR                                                                                                                              2 LOAD                                                                                                                          CR                                                              CR .( Saving system as TERM.COM)                                CR                                                                                                                              SAVE-SYSTEM TERM.COM  0 0 BDOS                                                                                                                                                                  ( TERMINAL PROGRAM LOAD SCREEN)                                                                                                 WARNING OFF                                                                                                                     FROM EDIT.BLK 1 LOAD                                                                                                            8 VIEWS TERM.BLK  OPEN TERM.BLK                                 6 41 THRU                                                                                                                       WARNING ON                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ( HARDWARE LAYER)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ( Com port interface)   HEX                                                                                                  VARIABLE COM#       ( com address)                              VARIABLE IRQ-MASK   ( irq mask for the selected com port)       VARIABLE INT-#      ( interrupt number for the com port)                                                                        : COM1   3F8 COM# !  10 IRQ-MASK !  0C INT-# ! ;                : COM2   2F8 COM# !   8 IRQ-MASK !  0B INT-# ! ;                : COM3   3E8 COM# !  10 IRQ-MASK !  0C INT-# ! ;                : COM4   2E8 COM# !   8 IRQ-MASK !  0B INT-# ! ;                                                                                COM1 ( or COM2 as you please)                                                                                                   : INT-VEC ( - seg offset)   0 INT-# @ 4 * ;                                                                                     2VARIABLE OLD-VEC ( a holding spot for the old ivecs)              ( Com port interface)   DECIMAL                                                                                              : PORT   CREATE ,  DOES> @ COM# @ + ;                                                                                           0 PORT ^RBR     4 PORT ^MCR                                     0 PORT ^THR     5 PORT ^LSR                                     1 PORT ^IER     6 PORT ^MSR                                     2 PORT ^IIR     0 PORT ^DLL                                     3 PORT ^LCR     1 PORT ^DLM                                                                                                     VARIABLE RATE                                                   : BAUD ( n)                                                        57600. ROT U2/  UM/MOD RATE ! DROP ;                                                                                         19200 BAUD ( or whatever the default should be)                                                                                    ( Receive buffer for serial interrupt)   HEX                                                                                 7FF CONSTANT /BUF                                                                                                               CREATE BUF   /BUF 1+ ALLOT                                             BUF   /BUF 1+ ERASE                                                                                                      VARIABLE INTO-BUF   ( used only by the interrupt service)       VARIABLE OUTOF-BUF  ( used only by xkey)                                                                                        : XKEY@ ( - char)   OUTOF-BUF @ /BUF AND BUF + C@ ;                                                                             : XKEY? ( - flag)   INTO-BUF @ OUTOF-BUF @ <> ;                 : XKEY ( - char)   BEGIN  XKEY? UNTIL                              1 OUTOF-BUF +!  XKEY@ ;                                                                                                         ( Serial receive interrupt service)   HEX                                                                                    VARIABLE XOFF                                                                                                                   LABEL SERIAL       AX   PUSH  \                                                    BX   PUSH  \ save affected regs                                 DX   PUSH  \                                                    DS   PUSH  \                                                 CS AX   MOV   \                                                 AX DS   MOV   \ establish addressing                       COM# #) DX   MOV   \ get com port number                    INTO-BUF #) BX   MOV   \ where in buffer                                    BX   INC   \ increment                              BX INTO-BUF #)   MOV   \ save pointer                                                                                                                                                          ( continued...)   HEX                                                                                                                     BX AX   MOV   \ copy INTO-BUF                         OUTOF-BUF #) AX   SUB   \ INTO-BUF - OUTOF-BUF = #chars        /BUF 3 4 */ # AX   CMP   \ check for 3/4 full                                  >   IF    \ yes,                                           5 # DX   ADD   \ point to line status reg                                BEGIN \ wait for transmitter empty                       0 AL   IN    \ sample status                                 20 # AL   AND   \                                                   0<>   UNTIL \ until transmitter ready                        5 # DX   SUB   \ point back to data register                   13 # AL   MOV   \ xoff character                                   0 AL   OUT   \ send xoff                                  AL XOFF #)   MOV   \ mark xoff                                               THEN                                          ( continued...)   HEX                                                                                                                /BUF #  BX   AND   \ pointer mod buf_size                             0 AL   IN    \ read character                            AL BUF [BX]   MOV   \ into ring buffer                              20 # AL   MOV   \ send EOI to 8259                              20 # AL   OUT   \                                                    DS   POP   \                                                    DX   POP   \ restore registers                                  BX   POP   \                                                    AX   POP   \                                                         IRET  C;                                                                                                                                                                                                                                                                                                   ( Interrupt vector management)                                                                                               : SET-TRAP                                                         INT-VEC L2@  OLD-VEC 2!                                         MY-SEG SERIAL  INT-VEC L2! ;                                 : RESTORE-TRAP                                                     OLD-VEC 2@  INT-VEC L2! ;                                                                                                    CODE ENABLE  ( interrupts)     STI  NEXT C;                     CODE DISABLE ( interrupts)     CLI  NEXT C;                                                                                                                                                                                                                                                                                                                                                                                                                        ( 8250 uart initialization)   HEX                                                                                            : INIT-8250                                                                80 ^LCR PC!       ( select baud rate)                      RATE C@ ^DLL PC!                                             RATE 1+ C@ ^DLM PC!                                                     03 ^LCR PC!       ( No parity, 8 bits, 1 stop bit)              00 ^IER PC!       ( disable interrupts)                            ^LSR PC@ DROP  (  clear the registers)                          ^RBR PC@ DROP ;                                   : ENABLE-8250                                                              0B ^MCR PC!       ( set modem control)                           1 ^IER PC! ;     ( enable interrupts)               : DISABLE-8250                                                             00 ^MCR PC!       ( loopback and modem control)                 00 ^IER PC! ;     ( disable interrupts)                 ( 8259 interrupt controller initialization)   HEX                                                                            : UNMASK-8259                                                      021 PC@                  ( read 8259 int mask )                 IRQ-MASK @  NOT  AND     ( turn on desired level )              021 PC!  ;                                                   : MASK-8259                                                        021 PC@         ( read 8259 int mask )                          IRQ-MASK @ OR   ( turn off this level )                         021 PC! ;       ( write mask back to 8259 )                                                                                  : INSTALL ( interrupt service routines)                            DISABLE  INIT-8250 ENABLE-8250  SET-TRAP  UNMASK-8259  ENABLE   0 INTO-BUF !  0 OUTOF-BUF !  BUF /BUF 1+ ERASE ;             : REMOVE  ( interrupt service routines)   DISABLE                  MASK-8259  INIT-8250 DISABLE-8250  RESTORE-TRAP ENABLE ;        ( 8250 output routines)   HEX                                                                                                CODE XEMIT ( char)                                                         COM# #) DX   MOV   \ get com port number                            5 # DX   ADD   \ point to line status reg                                BEGIN \ wait for transmitter empty                       0 AL   IN    \ sample status                                 20 # AL   AND   \                                                   0<>   UNTIL \ until transmitter ready                        5 # DX   SUB   \ point back to data register                        AX   POP                                                      0 AL   OUT   \ SEND CHAR                                               NEXT C;                                                                                                 : XTYPE ( a #)                                                     ?DUP IF  0 DO  DUP C@ XEMIT  1+  LOOP  THEN DROP ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ( INTERFACE LAYER)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ( Status line)   HEX                                                                                                         CODE BLUE ( print a pretty blue line on the crt top)               920 # AX MOV  ATTRIBUTE 2+ #) BX MOV                            50 # CX MOV  10 INT   NEXT C;                                : .COM    ." COM"  COM# @                                          3F8 CASE  ." 1"  ;THEN   3E8 CASE  ." 3"  ;THEN                 2F8 CASE  ." 2"  ;THEN   2E8 CASE  ." 4"  ;THEN                 -1 ABORT" unknown com port" ;                                                                                                : .BAUD                                                             E100. RATE @ UM/MOD 2*  7 U.R ."  Baud  " DROP ;            : .LOGO                                                             ."  Harris RTX 2000   " ;                                   : .FILE    .PATH ." \ "  FILE @ 0= IF  ." ????????.???"  ELSE         FILE @ 1+ 8 2DUP -TRAILING TYPE + ." ." 3 TYPE THEN ;        ( Status line)   HEX                                                                                                         : .STATUS   XY@  0 0 AT BLUE  .LOGO .COM .BAUD .FILE  AT ;                                                                      CREATE "STATUS"   0A0 ALLOT                                                                                                     : @STATUS   .STATUS  VSEG @ 0  MY-SEG "STATUS"  0A0 LCMOVE ;    : !STATUS   MY-SEG "STATUS"  VSEG @ 0  0A0 LCMOVE ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ( Extended parameter interface)   DECIMAL                                                                                    : GET-NUMBER ( - n)                                                   0  4 0 DO  16 *  XKEY  DUP ASCII 9 > IF 7 - THEN                           15 AND +  LOOP ;                               : GET#S ( n - n .. n)                                              0 DO GET-NUMBER  LOOP ;                                                                                                      : GET-STRING ( a)                                                  DUP 1+ BEGIN ( a)                                                  XKEY  2DUP SWAP C!                                              WHILE                                                           1+ REPEAT                                                    1- OVER - SWAP C! ;                                                                                                                                                                             ( Parse a filename into DOS-FCB)                                                                                             : FILENAME ( - flag \ 0=no name, -1=filename)                      FILE @ IF  FLUSH  0 [ DOS ] !FILES  THEN                        HERE GET-STRING                                                 HERE C@ 0= IF  0  ;THEN                                         HERE COUNT  [ DOS ] DOS-FCB (!FCB)                              DOS-FCB !FILES -1 ;                                                                                                          ( you only get a zero if a string of zero characters was sent)                                                                                                                                                                                                                                                                                                                                                                                                     ( Creating and opening files)   DECIMAL                                                                                      : OPEN-FILE                                                        FILE @  DUP 15 BDOS [ DOS ]                                     DOS-ERR? IF  ." Can't open file."   0 FILE !  ;THEN             DUP FILE-SIZE 1-  SWAP MAXREC# ! ;                           : FILE-OPEN                                                        FILENAME IF  OPEN-FILE ;THEN  FILE? ;                                                                                        : MAKE-FILE                                                        FILE @  22 BDOS [ DOS ]                                         DOS-ERR? IF  ." Can't make file."  0 FILE !  THEN ;          : FILE-CREATE                                                      FILENAME IF  MAKE-FILE  OPEN-FILE  THEN ;                                                                                                                                                       ( Change or report current directory)                                                                                        : CHANGE-DIRECTORY                                                 HERE GET-STRING                                                 HERE C@ 0= IF .PATH ;THEN                                       HERE 1+ !PATH IF ." Invalid Path!" THEN ;                                                                                    : ?OPEN                                                            FILE @ IF EXIT THEN                                             BEEP                                                            CR CR  ." No file open!  Operation aborted.  "                         ." Please open a file."                                  CR CR  ." You may need to reset the RTX 2000 board now."        CR CR  IDLE ;                                                                                                                                                                                   ( Sequential file write)   DECIMAL                                                                                           : WRITE-BUF   [ DOS ]                                              8  FILE @ MAXREC# +!                                            PAD CAPACITY 1- BUFFER  1024 CMOVE  UPDATE                      PAD 1024 26 FILL ;                                                                                                           : KEEP ( offset char - offset')                                    OVER PAD + C!  1+  DUP 1024 = IF  DROP WRITE-BUF 0 THEN ;                                                                    : SEQUENTIAL    PAD 1024 26 FILL                                   0 BEGIN ( offset)                                                  XKEY  DUP 10 = IF  6 XEMIT  THEN  DUP >R  KEEP R>               26 = UNTIL                                                   IF  WRITE-BUF  THEN                                             FLUSH  FILE @ 16 BDOS DROP   6 XEMIT ;                          ( Block interface)   DECIMAL                                                                                                 : TRACK ( n f)   XY@  74 0 AT ROT EMIT ROT 4 U.R  AT ;                                                                          : SENDBLK ( n \ to the target)                                     DUP ASCII s TRACK                                               DUP  CAPACITY < NOT IF  DROP 0  THEN                            BLOCK  16 0 DO ( a)                                                64  2DUP -TRAILING XTYPE  13 XEMIT  +  LOOP  DROP ;                                                                       : RECEIVEBLK ( n \ from the target, write to disk)                 DUP ASCII r TRACK                                               DUP  BUFFER  1024 0 DO ( a)                                        XKEY  OVER C!  1+  LOOP DROP                                 CAPACITY < IF UPDATE FLUSH THEN                                 6 XEMIT ;                                                       ( printer shell)                                                                                                             : P-SHELL                                                          XY@ >R >R   0 0 AT  BLUE                                        BEGIN    0 0 AT  ." Starting screen number            "                 24 0 AT  QUERY BL WORD NUMBER? 0= WHILE                         2DROP                                                   REPEAT DROP  0 MAX                                              BEGIN   35 0 AT  ." Ending screen number              "                 59 0 AT  QUERY BL WORD NUMBER? 0= WHILE                         2DROP                                                   REPEAT DROP  CAPACITY 1- MIN   OVER MAX                         ."  Printing ..."                                               [ HIDDEN ] PR-START  1+ SWAP DO  I TRIAD  3 +LOOP                          12 EMIT  PR-STOP                                     R> R> AT ;                                                      ( The extended interface routine)                                                                                            : EXTENDED ( char \ excute extended functions)                     ASCII R CASE  1 GET#S ?OPEN SENDBLK            ;THEN            ASCII W CASE  1 GET#S ?OPEN RECEIVEBLK         ;THEN            ASCII X CASE  REMOVE  0 0 BDOS                 ;THEN            ASCII L CASE  1 GET#S ?OPEN LIST               ;THEN            ASCII E CASE  1 GET#S ?OPEN EDIT FLUSH         ;THEN            ASCII O CASE  2 GET#S ?OPEN OBLITERATE         ;THEN            ASCII B CASE  3 GET#S ?OPEN BLOCKS             ;THEN                                                                         ( continued on next screen...)                                                                                                                                                                                                                                                                                                        ( ... continued)                                                                                                             ASCII Q CASE  1 GET#S ?OPEN QX                 ;THEN            ASCII D CASE  DIR                              ;THEN            ASCII C CASE  CHANGE-DIRECTORY         @STATUS ;THEN            ASCII F CASE  FILE-OPEN                @STATUS ;THEN            ASCII N CASE  FILE-CREATE              @STATUS ;THEN            ASCII M CASE  1 GET#S ?OPEN MORE               ;THEN            ASCII A CASE  1 GET#S ?OPEN ADV                ;THEN            ASCII S CASE  ?OPEN SEQUENTIAL         @STATUS ;THEN            ASCII Z CASE  1 GET#S [ DOS ] SELECT   @STATUS ;THEN            ASCII P CASE  ?OPEN P-SHELL            @STATUS ;THEN                 ( else)  DROP BEEP ;                                                                                                                                                                                                                                       ( scrolling the display)   DECIMAL                                                                                           CODE SCROLL                                                        3 # AH MOV  0 # BH MOV  16 INT                                  24 # DH CMP  >= IF                                                 6 # AH MOV   1 # AL MOV  ATTRIBUTE #) BH MOV                    1 # CH MOV  0 # CL MOV                                          24 # DH MOV  79 # DL MOV                                        16 INT  NEXT                                                 THEN                                                            1 # DH ADD  2 # AH MOV  16 INT                                  NEXT  C;                                                                                                                     255 CONSTANT 4th                                                : DUMB  DROP ;                                                                                                                     ( dumb terminal interface for Indelko RTX-kit)                                                                               : SLOWSEND                                                         DUP ASCII s TRACK                                               DUP  CAPACITY < NOT IF  DROP 0  THEN                            BLOCK  1024 XTYPE ;                                                                                                          : DUMB ( n)                                                        DUP 0< IF  32767 AND  ?OPEN  RECEIVEBLK  ;THEN                                        ?OPEN  SLOWSEND    ;                                                                                   59 CONSTANT 4th                                                                                                                                                                                                                                                                                                                    ( remote server)   DECIMAL                                                                                                   : ?XON                                                             INTO-BUF @ OUTOF-BUF @ -  [ /BUF 4 / ] LITERAL                  < IF  0 XOFF !  17 XEMIT  THEN ;                                                                                             : REMOTE                                                           XKEY? IF ( a character is waiting)                                 XOFF @ IF ( xoff was set)  ?XON  THEN                           XKEY  DUP 0= IF  XKEY 256 * XKEY + DUMB   ;THEN                 DUP 10 = IF  DROP SCROLL                  ;THEN                 DUP  1 = IF  DROP XKEY EXTENDED  !STATUS  ;THEN                 ( else)  EMIT                                                ELSE                                                               VSEG @ 0 L@ 5920 XOR IF !STATUS THEN                         THEN ;                                                          ( adjust the com port address)                                                                                               : ADJUSTING-COM                                                    ASCII 1 CASE   COM1  ;THEN                                      ASCII 2 CASE   COM2  ;THEN                                      ASCII 3 CASE   COM3  ;THEN                                      ASCII 4 CASE   COM4  ;THEN                                                     DROP  ;                                                                                                       : ADJUST-COM                                                       XY@ >R >R  0 0 AT  BLUE .COM  15 0 AT                           ." 1=COM1  2=COM2  3=COM3  4=COM4  other=NO CHANGE"             KEY ADJUSTING-COM                                               R> R> AT ;                                                                                                                                                                                      ( adjust baud rate)                                                                                                          : ADJUSTING-BAUD                                                   ASCII + CASE  RATE @ 2/   3 MAX  RATE !  1 ;THEN                ASCII - CASE  RATE @ 2* 384 MIN  RATE !  1 ;THEN                ASCII = CASE  RATE @ 2/   3 MAX  RATE !  1 ;THEN                ASCII _ CASE  RATE @ 2* 384 MIN  RATE !  1 ;THEN                     13 CASE                             0 ;THEN                                                  DROP   1 ;                                                                                 : ADJUST-BAUD                                                      XY@ >R >R  0 0 AT  BLUE   .BAUD  15 0 AT                        ." + to increase, - to decrease, <Enter> to accept."            BEGIN  KEY ADJUSTING-BAUD  WHILE  0 0 AT .BAUD  REPEAT          R> R> AT ;                                                                                                                      ( save configuration)                                                                                                        CREATE FILENAME  ," MYTERM.COM"                                                                                                 : SAVETERM  [ DOS ]                                                XY@ >R >R  0 0 AT BLUE                                          ." Save the current configuration as MYTERM.COM ? (y/n) "       KEY  BL OR  ASCII y = IF                                           FILENAME COUNT FCB2 (!FCB)                                      FCB2 DELETE DROP                                                FCB2 MAKE-FILE                                                  HEADER                                                          256 HERE BOUNDS DO  I SET-DMA  FCB2 WRITE  128 +LOOP            FCB2 CLOSE                                                      ."   Saved."                                                 THEN  R> R> AT ;                                                ( return to dos)                                                                                                             : TO-DOS                                                           XY@ >R >R  0 0 AT  BLUE                                         ." Return to DOS? (y/n) "                                       KEY  BL OR  ASCII y = IF  PAGE 0 0 BDOS  THEN                   R> R> AT ;                                                                                                                   : TO-FORTH                                                         REMOVE ( the interrupt structure)                               CR  ." Exiting to host."                                        CR  ." Type  TERM  to reconnect to RTX 2000."                   ['] QUIT IS IDLE                                                CR QUIT ;                                                                                                                                                                                       ( Special local functions)                                                                                                   DEFER HELP                                                                                                                      : SPECIAL ( char)                                                  104 CASE ( alt-f1 )  REMOVE  ADJUST-COM  INSTALL ;THEN          105 CASE ( alt-f2 )  REMOVE  ADJUST-BAUD INSTALL ;THEN          106 CASE ( alt-f3 )  REMOVE  SAVETERM    INSTALL ;THEN          113 CASE ( alt-f4 )  REMOVE  TO-DOS      INSTALL ;THEN          4th CASE ( patched)          TO-FORTH            ;THEN           35 CASE ( ALT-H  )  HELP                        ;THEN                   ( others )  0 XEMIT XEMIT               ;                                                                                                                                                                                                                                                                              ( Manage the PC's keyboard)   DECIMAL                                                                                        : KEYBOARD                                                         KEY? IF   KEY                                                      DUP 255 = IF  DROP TO-FORTH  THEN                               ?DUP IF XEMIT  ;THEN                                            KEY SPECIAL @STATUS                                          THEN ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ( terminal program entry)                                                                                                    : DO-TERM  ( this is the main terminal program loop)               @STATUS ( generate current status display and remember it)      BEGIN   ( and service the keyboard and remote until forever)       KEYBOARD                                                        REMOTE                                                       AGAIN ; ( or until the operator exits via the trap door)                                                                     : TERM                                                             INSTALL ( the interrupt structure)                              ['] DO-TERM IS IDLE  DO-TERM ;                                                                                                                                                                                                                                                                                                  ( version tracking by date and time)   HEX                                                                                   CODE @T&D ( - year day month minute hour)                          2A # AH MOV  21 INT  0 # AX MOV                                 CX PUSH  DL AL MOV  AX PUSH  DH AL MOV  AX PUSH                 2C # AH MOV  21 INT  0 # AX MOV                                 CL AL MOV  AX PUSH  CH AL MOV  AX PUSH                          NEXT  C;                                                                                                                     : .T&D ( print time and date of compilation)                       DECIMAL  CR ." Version created at "   [ @T&D ]                  LITERAL 2 U.R ." :" LITERAL 2 U.R     ."  on "                  LITERAL 2 U.R ." /" LITERAL 2 U.R ." /" LITERAL 2 U.R ;                                                                                                                                                                                                         ( help)                                                                                                                      : <##>   0 <# # # #> TYPE ;                                                                                                     : <HELP> CR ." RTX 2000 Integrated Environment   "                          ." (c) 1989 Harris Semiconductor"                        CR  CR ." Created at "   [ @T&D ]                                   LITERAL <##> ." :" LITERAL <##> ."  on "                        LITERAL <##> ." /" LITERAL <##> ." /" LITERAL <##>          CR  CR ." alt-h  displays this help message"                    CR  CR ." alt-f1  alt-f2  alt-f3  alt-f4  alt-f5  "                    ." alt-f6  alt-f7  alt-f8  alt-f9  alt-f10"                  CR ."  COM     BAUD    SAVE    ----    ----   "                    ."  ----    ----    ----    ----    EXIT "  CR ;                                                                    ' <HELP> IS HELP                                                ( THE TERMINAL PROGRAM)   DECIMAL                                                                                               : TERMINAL                                                         ONLY FORTH ALSO DEFINITIONS  EMPTY-BUFFERS                      SP0 @ 'TIB !  RP0 @ RP!                                         128 COUNT TIB SWAP DUP #TIB C! CMOVE  BLK OFF  >IN OFF          0 STATE !  INTERPRET                                            128 128 ERASE                                                   0 [ DOS ] !FILES                                                COM# @  DUP 16 XOR COM# !  DISABLE-8250  COM# !                 VMODE@ 3 = IF COLOR ELSE MONO THEN                              VSEG @ 0 L@  256 /  255 AND  DUP ATTRIBUTE !                    DUP 16 / 15 AND  SWAP 15 AND 16 * OR  ATTRIBUTE 2+ !            PAGE   HELP CR CR TERM ;                                                                                                     ' TERMINAL IS BOOT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              